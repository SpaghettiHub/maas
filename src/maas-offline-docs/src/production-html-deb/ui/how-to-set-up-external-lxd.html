<!DOCTYPE html>
<html>
  <head>
    <title>How to set up external LXD</title>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      .collapsible {
	  cursor: pointer;
	  border: none;
	  outline: none;
	  margin: 0;
	  padding:0;
      }

      .content {
	  display: none;
	  overflow: hidden;
      }

      .collapsible:after {
	  content: '\003E'; /* Unicode right-pointing arrow */
	  float: right;
      }
      .collapsible.active:after {
	  content: 'v'; 
      }
    </style>
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      #sidebar ul {margin-left:0;margin-top:0;margin-bottom:0;list-style-type:none;padding-left:20px;}
      #sidebar li {margin: 4px 0;}
      #sidebar details {margin-top:0;margin-bottom:0;}
      #sidebar details > summary {
	  padding: 0px;
	  margin-top: 0px;
	  margin-bottom: 0px;
	  width: 200px;
	  background-color: #ffffff;
	  border: none;
	  cursor: pointer;
    	  list-style-type: "< ";
	  direction: rtl;
      }
      #sidebar details[open] > summary {
	  list-style-type: "v ";
      }

      </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;
      <strong>Offline docs</strong>
      <a href="https://maas.io/docs">(switch to live docs)</a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <!-- this is left in just in case we have to update --
	-- older html versions that still use tabs; tbh, we --
	-- should be slowly doing  away with these; other --
	-- changes will be needed, since the older directory --
	-- structures are no longer differentiated, but left --
	-- in place for now so we don't have to dork around --
	-- with the build tools, which expect the subdirs -->
          </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <ul>
	<li>
	  <a href="maas-documentation.html"><b>MAAS Documentation</b></a>
	</li>
        <hr style="margin-top: 15px;">
	<li>
 	  <button class="collapsible" id="m01"><a href="tutorials.html">Tutorials&nbsp;&nbsp;&nbsp;</a></button>
	  <div class="content" id="m02">
	    <ul>
	      <li>
		<a href="tutorial-bootstrapping-maas.html">Bootstrapping MAAS</a>
	      </li>
	      <li>
		<a href="tutorial-try-the-maas-cli.html">Try the MAAS CLI</a>
	      </li>
	      <li>
		<a href="tutorial-creating-custom-images.html">Creating custom images</a>
	      </li>
	      <li>
		<a href="tutorial-get-fancy-cli-output.html">Get fancy CLI output</a>
	      </li>
	    </ul>
	  </div>
	</li>
	<hr style="margin-top: 15px;">
	<li>
	  <button class="collapsible" id="m03"><a href="how-to-guides.html">How-to guides&nbsp;&nbsp;&nbsp;</a></button>
	  <div class="content" id="m04">
	    <ul>
	      <li>
		<button class="collapsible" id="m05"><a href="how-to-set-up-maas.html">Set up MAAS&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m06">
		  <ul>
		    <li>
		      <a href="how-to-install-maas.html">Install MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-upgrade-maas.html">Upgrade MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-back-up-maas.html">Back up MAAS</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m07"><a href="how-to-manage-maas-networks.html">Manage MAAS networks&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m08">
		  <ul>
		    <li>
		      <a href="how-to-connect-maas-networks.html">Connect MAAS networks</a>
		    </li>
		    <li>
		      <a href="how-to-enable-dhcp.html">Enable DHCP</a>
		    </li>
		    <li>
		      <a href="how-to-use-availability-zones.html">Use availability zones</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m09"><a href="how-to-manage-maas-images.html">Manage MAAS images&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m10">
		  <ul>
		    <li>
		      <a href="how-to-use-standard-images.html">Use standard images</a>
		    </li>
		    <li>
		      <a href="how-to-mirror-maas-images.html">Mirror MAAS images</a>
		    </li>
		    <li>
		      <a href="how-to-deploy-a-real-time-kernel.html">Deploy a real-time kernel</a>
		    </li>
		    <li>
		      <a href="how-to-use-vmware-images.html">Use VMWare images</a>
		    </li>
		    <li>
		      <a href="how-to-deploy-a-fips-compliant-kernel.html">Deploy a FIPS-compliant kernel</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m12"><a href="how-to-customise-images.html">Customise images&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m13">
		  <ul>
		    <li>
		      <a href="how-to-build-maas-images.html">Build MAAS images</a>
		    </li>
		    <li>
		      <a href="how-to-build-an-ubuntu-image.html">Build an Ubuntu image</a>
		    </li>
		    <li>
		      <a href="how-to-build-a-rhel-7-image.html">Build a RHEL 7 image</a>
		    </li>
		    <li>
		      <a href="how-to-build-a-rhel-8-image.html">Build a RHEL 8 image</a>
		    </li>
		    <li>
		      <a href="how-to-build-a-centos-7-image.html">Build a CentOS 7 image</a>
		    </li>
		    <li>
		      <a href="how-to-build-an-esxi-image.html">Build an ESXi image</a>
		    </li>
		    <li>
		      <a href="how-to-build-a-windows-image.html">Build a Windows image</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m14"><a href="how-to-manage-controllers.html">Manage controllers&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m15">
		  <ul>
		    <li>
		      <a href="how-to-configure-controllers.html">Configure controllers</a>
		    </li>
		    <li>
		      <a href="how-to-enable-high-availability.html">Enable high availability</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m16"><a href="how-to-use-machines.html">Use machines&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m17">
		  <ul>
		    <li>
		      <a href="how-to-manage-machines.html">Manage machines</a>
		    </li>
		    <li>
		      <a href="how-to-customise-machines.html">Customise machines</a>
		    </li>
		    <li>
		      <a href="how-to-commission-machines-with-maas.html">Commission machines</a>
		    </li>
		    <li>
		      <a href="how-to-allocate-machines-with-maas.html">Allocate machines</a>
		    </li>
		    <li>
		      <a href="how-to-deploy-machines-with-maas.html">Deploy machines</a>
		    </li>
		    <li>
		      <a href="how-to-use-resource-pools.html">Use resource pools</a>
		    </li>
		    <li>
		      <a href="how-to-set-up-power-drivers.html">Set up power drivers</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m18"><a href="how-to-manage-storage.html">Manage storage&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m19">
		  <ul>
		    <li>
		      <a href="how-to-configure-storage-layouts.html">Configure storage layouts</a>
		    </li>
		    <li>
		      <a href="how-to-manage-block-devices.html">Manage block devices</a>
		    </li>
		    <li>
		      <a href="how-to-manage-partitions.html">Manage partitions</a>
		    </li>
		    <li>
		      <a href="how-to-manage-vmfs-datastores.html">Manage VMFS datastores</a>
		    </li>
		    <li>
		      <a href="how-to-create-custom-storage.html">Create custom storage</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m20"><a href="how-to-use-virtual-machines.html">Use virtual machines&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m21">
		  <ul>
		    <li>
		      <a href="how-to-set-up-external-lxd.html">Set up external LXD</a>
		    </li>
		    <li>
		      <a href="how-to-use-external-lxd.html">Use external LXD</a>
		    </li>
		    <li>
		      <a href="how-to-use-lxd-projects.html">Use LXD projects</a>
		    </li>
		    <li>
		      <a href="how-to-manage-virtual-machines.html">Manage virtual machines</a>
		    </li>
		    <li>
		      <a href="how-to-deploy-vms-on-ibm-z.html">Deploy VMs on IBM Z</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m22"><a href="how-to-label-machines.html">Label machines&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m23">
		  <ul>
		    <li>
		      <a href="how-to-manage-tags.html">Manage
			tags</a>
		    </li>
		    <li>
		      <a href="how-to-annotate-machines.html">Annotate
			machines</a>
		    </li>
		    <li>
		      <a href="how-to-use-machine-tags.html">Use
			machine tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-controller-tags.html">Use
			controller tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-storage-tags.html">Use
			storage tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-network-tags.html">Use
			network tags</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m24"><a href="how-to-use-logging.html">Use logging&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m25">
		  <ul>
		    <li>
		      <a href="how-to-read-event-logs.html">Read event logs</a>
		    </li>
		    <li>
		      <a href="how-to-review-audit-logs.html">Review audit logs</a>
		    </li>
		    <li>
		      <a href="how-to-read-commissioning-logs.html">Read commissioning logs</a>
		    </li>
		    <li>
		      <a href="how-to-interpret-testing-logs.html">Interpret testing logs</a>
		    </li>
		    <li>
		      <a href="how-to-use-maas-systemd-logs.html">Use MAAS systemd logs</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m26"><a href="how-to-secure-maas.html">Secure MAAS&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m27">
		  <ul>
		    <li>
		      <a href="how-to-enhance-maas-security">Enhance MAAS security</a>
		    </li>
		    <li>
		      <a href="how-to-manage-user-access.html">Manage user access</a>
		    </li>
		    <li>
		      <a href="how-to-implement-tls.html">Implement TLS</a>
		    </li>
		    <li>
		      <a href="how-to-integrate-vault.html">Integrate Vault</a>
		    </li>
		    <li>
		      <a href="how-to-configure-an-air-gapped-maas.html">Configure an air-gapped MAAS</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m28"><a href="how-to-change-maas-settings.html">Change MAAS settings&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m29">
		  <ul>
		    <li>
		      <a href="how-to-change-maas-3-4-settings.html">Change MAAS 3.4 settings</a>
		    </li>
		    <li>
		      <a href="how-to-change-maas-3-3-settings.html">Change MAAS 3.3 settings</a>
		    </li>
		    <li>
		      <a href="how-to-change-settings-with-the-cli.html">Change settings with the CLI</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m30"><a href="how-to-operate-maas.html">Operate MAAS&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m31">
		  <ul>
		    <li>
		      <a href="how-to-locate-machines.html">Locate machines</a>
		    </li>
		    <li>
		      <a href="how-to-monitor-maas.html">Monitor MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-audit-maas.html">Audit MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-upgrade-postgresql-v12-to-v14.html">Upgrade PostgreSQL v12 to v14</a>
		    </li>
		    <li>
		      <a href="how-to-troubleshoot-common-issues.html">Troubleshoot common issues</a>
		    </li>
		    <li>
		      <a href="how-to-authenticate-to-the-maas-api.html">Authenticate to the MAAS API</a>
		    </li>
		    <li>
		      <a href="how-to-use-the-python-api-client.html">Use the Python API client</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m32"><a href="how-to-join-the-community.html">Join the community&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m33">
		  <ul>
		    <li>
		      <a href="how-to-engage-on-the-discourse-forum.html">Engage on the Discourse forum</a>
		    </li>
		    <li>
		      <a href="https://ubuntu.com/pro">How to get support</a>
		    </li>
		    <li>
		      <a href="how-to-request-features.html">Request features</a>
		    </li>
		    <li>
		      <a href="how-to-report-and-review-bugs.html">Report and review bugs</a>
		    </li>
		    <li>
		      <a href="how-to-contribute-to-maas-documentation.html">Contribute to MAAS documentation</a>
		    </li>
		    <li>
		      <a href="how-to-contact-us.html">How to contact us</a>
		    </li>
		  </ul>
		</div>
	      </li>
	    </ul>
	  </div>
	</li>
	<hr style="margin-top: 15px;">
	<li>
	  <button class="collapsible" id="m34"><a href="reference.html">Reference&nbsp;&nbsp;&nbsp;</a></button>
	  <div class="content" id="m35">
	    <ul>
	      <li>
		<button class="collapsible" id="m36"><a href="reference-general-information.html">General information&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m37">
		  <ul>
		    <li>
		      <a href="reference-installation-requirements.html">Installation requirements</a>
		    </li>
		    <li>
		      <a href="https://launchpad.net/maas">MAAS source code</a>
		    </li>
		    <li>
		      <a href="reference-documentation-style-guide.html">Documentation style guide</a>
		    </li>
		    <li>
		      <a href="reference-maas-glossary.html">MAAS glossary</a>
		    </li>
		    <li>
		      <a href="https://ubuntu.com/community/code-of-conduct">MAAS community code of conduct</a>
		    </li>
		    <li>
		      <a href="reference-api-documentation.html">MAAS API reference</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m38"><a href="reference-maas-scripts.html">Scripts and automation&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m39">
		  <ul>
		    <li>
		      <a href="reference-commissioning-scripts.html">Commissioning scripts</a>
		    </li>
		    <li>
		      <a href="reference-hardware-test-scripts.html">Hardware test scripts</a>
		    </li>
		    <li>
		      <a href="reference-terraform.html">Terraform IAC</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<a href="reference-device-labels.html">Device labels</a>
	      </li>
	      <li>
		<a href="reference-maas-metrics.html">MAAS metrics</a>
	      </li>
	      <li>
		<a href="reference-power-drivers.html">Power drivers</a>
	      </li>
	      <li>
		<a href="reference-bmc-drivers.html">BMC drivers</a>
	      </li>
	      <li>
		<a href="reference-maas-storage.html">Storage reference</a>
	      </li>
	      <li>
		<button class="collapsible" id="m40"><a href="reference-release-notes.html">Release notes and version details&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m41">
		  <ul>
		    <li>
		      <a href="reference-release-notes-maas-3-4.html">MAAS
			3.4 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-3-3.html">MAAS
			3.3 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-3-2.html">MAAS
			3.2 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-3-1.html">MAAS
			3.1 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-3-0.html">MAAS
			3.0 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-2-9.html">MAAS
			2.9 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-2-8.html">MAAS
			2.8 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-2-7.html">MAAS
			2.7 release notes</a>
		    </li>
		  </ul>
		</div>
	      </li>
	    </ul>
	  </div>
	</li>
	<hr style="margin-top: 15px;">
	<li>
	  <button class="collapsible" id="m42"><a href="explanation.html">Explanation&nbsp;&nbsp;&nbsp;</a></button>
	  <div class="content" id="m43">
	    <ul>
	      <li>
		<a href="about-maas.html">MAAS</a>
	      </li>
	      <li>
		<button class="collapsible" id="m44"><a href="about-machines.html">Machines&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m45">
		  <ul>
		    <li>
		      <a    href="about-machine-basics.html">Machine
			basics</a>
		    </li>
		    <li>
		      <a href="about-commissioning-machines.html">Commissioning
			machines</a>
		    </li>
		    <li>
		      <a href="about-the-machine-life-cycle.html">The
			machine life-cycle</a>
		    </li>
		    <li>
		      <a href="about-deploying-machines.html">Deploying
			machines</a>
		    </li>
		    <li>
		      <a href="about-machine-customisation.html">Machine
			customisation</a>
		    </li>
		    <li>
		      <a href="about-deploying-running-machines.html">Deploying
			running machines</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m46"><a href="about-virtual-machines.html">Virtual machines&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m47">
		  <ul>
		    <li>
		      <a href="about-lxd.html">LXD</a>
		    </li>
		    <li>
		      <a href="about-lxd-projects.html">LXD projects</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m48"><a href="about-images.html">Images&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m49">
		  <ul>
		    <li>
		      <a href="about-standard-images.html">Standard images</a>
		    </li>
		    <li>
		      <a href="about-custom-images.html">Custom images</a>
		    </li>
		  </ul>
		</div>
	      <li>
		<a href="about-controllers.html">Controllers</a>
	      </li>
	      <li>
		<a href="about-device-labels.html">Device labels</a>
	      </li>
	      <li>
		<button class="collapsible" id="m50"><a href="about-maas-networks.html">MAAS networks&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m51">
		  <ul>
		    <li>
		      <a href="about-the-osi-model.html">The OSI model</a>
		    </li>
		    <li>
		      <a href="about-tcp-ip.html">TCP/IP</a>
		    </li>
		    <li>
		      <a href="about-dhcp-in-maas.html">DHCP in MAAS</a>
		    </li>
		    <li>
		      <a href="about-cloud-networking.html">Cloud networking</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m52"><a href="about-monitoring-and-logging.html">Monitoring and logging&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m53">
		  <ul>
		    <li>
		      <a href="about-maas-performance.html">MAAS performance</a>
		    </li>
		    <li>
		      <a href="about-maas-events.html">MAAS events</a>
		    </li>
		    <li>
		      <a href="about-audit-events.html">Audit events</a>
		    </li>
		    <li>
		      <a href="about-maas-logging.html">MAAS logging</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<a href="about-maas-security.html">Ensuring security in MAAS</a>
	      </li>
	      <li>
	      </li>
	    </ul>
	  </div>
	</li>
      </ul>
    </div>
    <div class="container" style="float:left; width:60%; margin-left: 40px; margin-top:40px; margin-right:30px">
      
      <h1>How to set up external LXD</h1>
      <blockquote>
      <p><em>Errors or typos? Topics missing? Hard to read? <a href="https://docs.google.com/forms/d/e/1FAIpQLScIt3ffetkaKW3gDv6FDk7CfUTNYP_HGmqQotSTtj2htKkVBw/viewform?usp=pp_url&entry.1739714854=https://maas.io/docs/setting-up-lxd-for-vms" target = "_blank">Let us know.</a></em></p>
      </blockquote>
      <p>This page explains how to set up the LXD package to provide MAAS with virtual machines.</p>
      <h2 id="make-lxd-5.21-available">Make LXD 5.21 available</h2>
      <p>Assuming that you want to use LXD <a href="how-to-use-virtual-machines.html">VM hosts</a>, you need to install the correct version of LXD, which is 5.21. Older versions will not function correctly with MAAS.</p>
      <h2 id="remove-older-versions-of-lxd">Remove older versions of LXD</h2>
      <p>If you’re on a version of Ubuntu older than 20.04, or you have the Debian version of LXD, start the uninstall process with the following command:</p>
      <pre class="nohighlight"><code>sudo apt-get purge -y *lxd* *lxc*</code></pre>
      <p>This command should result in output that looks something like this:</p>
      <pre class="nohighlight"><code>Reading package lists... Done
      Building dependency tree      
      Reading state information... Done
      Note, selecting &#39;lxde-core&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;python-pylxd-doc&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;python3-pylxd&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;python-nova-lxd&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;lxde-common&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;lxde-icon-theme&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;lxde-settings-daemon&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;lxde&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;lxdm&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;lxd&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;lxd-tools&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;python-pylxd&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;lxdm-dbg&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;lxde-session&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;nova-compute-lxd&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;openbox-lxde-session&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;python-nova.lxd&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;lxd-client&#39; for glob &#39;*lxd*&#39;
      Note, selecting &#39;openbox-lxde-session&#39; instead of &#39;lxde-session&#39;
      Note, selecting &#39;lxctl&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;lxc-common&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;python3-lxc&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;libclxclient-dev&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;lxc-templates&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;lxc1&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;lxc-dev&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;lxc&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;liblxc1&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;lxc-utils&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;vagrant-lxc&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;libclxclient3&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;liblxc-dev&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;nova-compute-lxc&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;python-lxc&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;liblxc-common&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;golang-gopkg-lxc-go-lxc.v2-dev&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;lxcfs&#39; for glob &#39;*lxc*&#39;
      Note, selecting &#39;liblxc-common&#39; instead of &#39;lxc-common&#39;
      Package &#39;golang-gopkg-lxc-go-lxc.v2-dev&#39; is not installed, so not removed
      Package &#39;libclxclient-dev&#39; is not installed, so not removed
      Package &#39;libclxclient3&#39; is not installed, so not removed
      Package &#39;lxc-templates&#39; is not installed, so not removed
      Package &#39;lxctl&#39; is not installed, so not removed
      Package &#39;lxde&#39; is not installed, so not removed
      Package &#39;lxde-common&#39; is not installed, so not removed
      Package &#39;lxde-core&#39; is not installed, so not removed
      Package &#39;lxde-icon-theme&#39; is not installed, so not removed
      Package &#39;lxde-settings-daemon&#39; is not installed, so not removed
      Package &#39;lxdm&#39; is not installed, so not removed
      Package &#39;lxdm-dbg&#39; is not installed, so not removed
      Package &#39;openbox-lxde-session&#39; is not installed, so not removed
      Package &#39;python-lxc&#39; is not installed, so not removed
      Package &#39;python3-lxc&#39; is not installed, so not removed
      Package &#39;vagrant-lxc&#39; is not installed, so not removed
      Package &#39;liblxc-dev&#39; is not installed, so not removed
      Package &#39;lxc-dev&#39; is not installed, so not removed
      Package &#39;nova-compute-lxc&#39; is not installed, so not removed
      Package &#39;nova-compute-lxd&#39; is not installed, so not removed
      Package &#39;python-nova-lxd&#39; is not installed, so not removed
      Package &#39;python-pylxd&#39; is not installed, so not removed
      Package &#39;python-pylxd-doc&#39; is not installed, so not removed
      Package &#39;lxc&#39; is not installed, so not removed
      Package &#39;lxc-utils&#39; is not installed, so not removed
      Package &#39;lxc1&#39; is not installed, so not removed
      Package &#39;lxd-tools&#39; is not installed, so not removed
      Package &#39;python-nova.lxd&#39; is not installed, so not removed
      Package &#39;python3-pylxd&#39; is not installed, so not removed
      The following packages were automatically installed and are no longer required:
        dns-root-data dnsmasq-base ebtables libuv1 uidmap xdelta3
      Use &#39;sudo apt autoremove&#39; to remove them.
      The following packages will be REMOVED:
        liblxc-common* liblxc1* lxcfs* lxd* lxd-client*
      0 upgraded, 0 newly installed, 5 to remove and 21 not upgraded.
      After this operation, 34.1 MB disk space will be freed.
      (Reading database ... 67032 files and directories currently installed.)
      Removing lxd (3.0.3-0ubuntu1~18.04.1) ...
      Removing lxd dnsmasq configuration
      Removing lxcfs (3.0.3-0ubuntu1~18.04.2) ...
      Removing lxd-client (3.0.3-0ubuntu1~18.04.1) ...
      Removing liblxc-common (3.0.3-0ubuntu1~18.04.1) ...
      Removing liblxc1 (3.0.3-0ubuntu1~18.04.1) ...
      Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
      Processing triggers for libc-bin (2.27-3ubuntu1) ...
      (Reading database ... 66786 files and directories currently installed.)
      Purging configuration files for liblxc-common (3.0.3-0ubuntu1~18.04.1) ...
      Purging configuration files for lxd (3.0.3-0ubuntu1~18.04.1) ...
      Purging configuration files for lxcfs (3.0.3-0ubuntu1~18.04.2) ...
      Processing triggers for systemd (237-3ubuntu10.40) ...
      Processing triggers for ureadahead (0.100.0-21) ...</code></pre>
      <p>You should also autoremove packages no longer needed by LXD:</p>
      <pre class="nohighlight"><code>$ sudo apt-get autoremove -y</code></pre>
      <p>Output from this command should be similar to:</p>
      <pre class="nohighlight"><code>Reading package lists... Done
      Building dependency tree      
      Reading state information... Done
      The following packages will be REMOVED:
        dns-root-data dnsmasq-base ebtables libuv1 uidmap xdelta3
      0 upgraded, 0 newly installed, 6 to remove and 21 not upgraded.
      After this operation, 1860 kB disk space will be freed.
      (Reading database ... 66769 files and directories currently installed.)
      Removing dns-root-data (2018013001) ...
      Removing dnsmasq-base (2.79-1) ...
      Removing ebtables (2.0.10.4-3.5ubuntu2.18.04.3) ...
      Removing libuv1:amd64 (1.18.0-3) ...
      Removing uidmap (1:4.5-1ubuntu2) ...
      Removing xdelta3 (3.0.11-dfsg-1ubuntu1) ...
      Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
      Processing triggers for libc-bin (2.27-3ubuntu1) ...</code></pre>
      <p>Now install LXD from the Snap:</p>
      <pre class="nohighlight"><code>$ sudo snap install lxd
      2020-05-20T22:02:57Z INFO Waiting for restart...
      lxd 4.1 from Canonical✓ installed</code></pre>
      <h2 id="refresh-lxd">Refresh LXD</h2>
      <p>If you are on 20.04 or above LXD should be installed by default, but it’s a good idea to make sure it’s up to date:</p>
      <pre class="nohighlight"><code>$ sudo snap refresh
      All snaps up to date.</code></pre>
      <h2 id="initialise-lxd-prior-to-use">Initialise LXD prior to use</h2>
      <p>Once LXD is installed it needs to be configured with <code>lxd init</code> before first use:</p>
      <pre class="nohighlight"><code>$ sudo lxd init</code></pre>
      <p>Your interactive output should look something like the following. Note a few points important points about these questions:</p>
      <ol type="1">
      <li><p><code>Would you like to use LXD clustering? (yes/no) [default=no]: no</code> - support for LXD clusters was added in MAAS v3.1.</p></li>
      <li><p><code>Name of the storage back-end to use (btrfs, dir, lvm, zfs, ceph) [default=zfs]: dir</code> - testing has primarily been with dir; other options should work, but less testing has been done, so use at your own risk.</p></li>
      <li><p><code>Would you like to connect to a MAAS server? (yes/no) [default=no]: no</code> - When LXD is connected to MAAS containers or virtual machines created by LXD will be automatically added to MAAS as devices. This feature should work, but has limited testing thus far.</p></li>
      <li><p><code>Would you like to configure LXD to use an existing bridge or host interface? (yes/no) [default=no]: yes</code> - The bridge LXD creates is isolated and not managed by MAAS. If this bridge is used, you would be able to add the LXD VM host and compose virtual machines, but commissioning, deploying, and any other MAAS action which uses the network will fail – so <code>yes</code> is the correct answer here.</p></li>
      <li><p><code>Name of the existing bridge or host interface: br0</code> - br0 is the name of the bridge the user configured (see sections above) which is connected to a MAAS-managed network.</p></li>
      <li><p><code>Trust password for new clients:</code> - This is the password the user will enter when connecting with MAAS.</p></li>
      </ol>
      <pre class="nohighlight"><code>Would you like to use LXD clustering? (yes/no) [default=no]: no
      Do you want to configure a new storage pool? (yes/no) [default=yes]: yes
      Name of the new storage pool [default=default]:  
      Name of the storage back-end to use (btrfs, dir, lvm, zfs, ceph) [default=zfs]: dir
      Would you like to connect to a MAAS server? (yes/no) [default=no]: no
      Would you like to create a new local network bridge? (yes/no) [default=yes]: no
      Would you like to configure LXD to use an existing bridge or host interface? (yes/no) [default=no]: yes
      Name of the existing bridge or host interface: br0
      Would you like LXD to be available over the network? (yes/no) [default=no]: yes
      Address to bind LXD to (not including port) [default=all]:
      Port to bind LXD to [default=8443]:
      Trust password for new clients:
      Again:
      Would you like stale cached images to be updated automatically? (yes/no) [default=yes]
      Would you like a YAML &quot;lxd init&quot; preseed to be printed? (yes/no) [default=no]:</code></pre>
      <p>After initialising LXD, you will also want to make sure that LXD is not trying to provide DHCP for the new local network bridge. You can check this with the following command:</p>
      <pre class="nohighlight"><code>lxc network show lxdbr0</code></pre>
      <p>If you didn’t accept the default bridge name (lxdbr0), substitute your name for that new bridge in the command above. This will produce output something like this:</p>
      <pre class="nohighlight"><code>config:
        dns.mode: managed
        ipv4.address: 10.146.214.1/24
        ipv4.dhcp: &quot;true&quot;
        ipv4.nat: &quot;true&quot;
        ipv6.address: fd42:c560:ee59:bb2::1/64
        ipv6.dhcp: &quot;true&quot;
        ipv6.nat: &quot;true&quot;
      description: &quot;
      name: lxdbr0
      type: bridge
      used_by:
      - /1.0/profiles/default
      managed: true
      status: Created
      locations:
      - none</code></pre>
      <p>There is a <a href="https://github.com/lxc/lxd/blob/master/doc/networks.md">quick tutorial</a><strong>^</strong> on the possible settings here. For simplicity, to turn off LXD-provided DHCP, you need to change three settings, as follows:</p>
      <pre class="nohighlight"><code>lxc network set lxdbr0 dns.mode=none
      lxc network set lxdbr0 ipv4.dhcp=false
      lxc network set lxdbr0 ipv6.dhcp=false</code></pre>
      <p>You can check your work by repeating the <code>show</code> command:</p>
      <pre class="nohighlight"><code>$ lxc network show lxdbr0
      config:
        dns.mode: none
        ipv4.address: 10.146.214.1/24
        ipv4.dhcp: &quot;false&quot;
        ipv4.nat: &quot;true&quot;
        ipv6.address: fd42:c560:ee59:bb2::1/64
        ipv6.dhcp: &quot;false&quot;
        ipv6.nat: &quot;true&quot;
      description: &quot;
      name: lxdbr0
      type: bridge
      used_by:
      - /1.0/profiles/default
      managed: true
      status: Created
      locations:
      - none</code></pre>
      <p>Once that’s done, the LXD host is now ready to be added to MAAS as an LXD VM host. Upon adding the VM host, its own commissioning information will be refreshed.</p>
      <p>When composing a virtual machine with LXD, MAAS uses either the ‘maas’ LXD profile, or (if that doesn’t exist) the ‘default’ LXD profile. The profile is used to determine which bridge to use. Users may also add additional LXD options to the profile which are not yet supported in MAAS.</p>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
	  let coll = document.getElementsByClassName("collapsible");

	  for (let i = 0; i < coll.length; i++) {
	      coll[i].addEventListener("click", function() {
		  toggleCollapsible(this);
	      });
	  }
      });

      function toggleCollapsible(element) {
	  element.classList.toggle("active");
	  let content = element.nextElementSibling;
	  if (content.style.display === "none" || content.style.display === "") {
	      content.style.display = "block";
	  } else {
	      content.style.display = "none";
	  }
      }

      // Assuming you have a way to identify which menu item should be open, e.g., via URL
      function openMenuItemBasedOnPage() {
	  let currentPage = window.location.href; // or however you determine the current page
	  let menuItem;

	  // Logic to determine which menu item corresponds to the current page
	  if (currentPage.includes("page1")) {
	      menuItem = document.getElementById("menu-item-1");
	  } else if (currentPage.includes("page2")) {
	      menuItem = document.getElementById("menu-item-2");
	  }

	  if (menuItem) {
	      toggleCollapsible(menuItem);
	      menuItem.classList.add("active");
	  }
      }

      // Call this function when the page loads
      openMenuItemBasedOnPage();
    </script>
  </body>
</html>

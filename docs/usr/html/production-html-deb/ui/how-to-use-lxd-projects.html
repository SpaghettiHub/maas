<!DOCTYPE html>
<html>
  <head>
    <title>How to use LXD projects</title>
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <style>
      .collapsible {
	  cursor: pointer;
	  border: none;
	  outline: none;
	  margin: 0;
	  padding:0;
      }

      .content {
	  display: none;
	  overflow: hidden;
      }

      .collapsible:after {
	  content: '\003E'; /* Unicode right-pointing arrow */
	  float: right;
      }
      .collapsible.active:after {
	  content: 'v'; 
      }
    </style>
    <style>
      #selector a:link{color:black;}
      #selector a:visited{color:black;}
      #selector a:active{color:black;}
      #selector a:hover{color:blue;}
      #sidebar a:link{color:black;}
      #sidebar a:visited{color:black;}
      #sidebar a:active{color:black;}
      #sidebar a:hover{color:blue;}
      #sidebar ul {margin-left:0;margin-top:0;margin-bottom:0;list-style-type:none;padding-left:20px;}
      #sidebar li {margin: 4px 0;}
      #sidebar details {margin-top:0;margin-bottom:0;}
      #sidebar details > summary {
	  padding: 0px;
	  margin-top: 0px;
	  margin-bottom: 0px;
	  width: 200px;
	  background-color: #ffffff;
	  border: none;
	  cursor: pointer;
    	  list-style-type: "< ";
	  direction: rtl;
      }
      #sidebar details[open] > summary {
	  list-style-type: "v ";
      }

      </style>
  </head>
  <body>
    <div id="selector" style="top:0; position:fixed; float:right; background-color:#d9d9d9; width:100%;border-bottom:1px solid black;">
      &nbsp;&nbsp;
      <strong>Offline docs</strong>
      <a href="https://maas.io/docs">(switch to live docs)</a>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <!-- this is left in just in case we have to update --
	-- older html versions that still use tabs; tbh, we --
	-- should be slowly doing  away with these; other --
	-- changes will be needed, since the older directory --
	-- structures are no longer differentiated, but left --
	-- in place for now so we don't have to dork around --
	-- with the build tools, which expect the subdirs -->
          </div>
    <div id="sidebar" style="float:left; width:25%;margin-top:40px; margin-left:20px">
      <ul>
	<li>
	  <a href="maas-documentation.html"><b>MAAS Documentation</b></a>
	</li>
        <hr style="margin-top: 15px;">
	<li>
 	  <button class="collapsible" id="m01"><a href="tutorials.html">Tutorials&nbsp;&nbsp;&nbsp;</a></button>
	  <div class="content" id="m02">
	    <ul>
	      <li>
		<a href="tutorial-bootstrapping-maas.html">Bootstrapping MAAS</a>
	      </li>
	      <li>
		<a href="tutorial-try-the-maas-cli.html">Try the MAAS CLI</a>
	      </li>
	      <li>
		<a href="tutorial-creating-custom-images.html">Creating custom images</a>
	      </li>
	      <li>
		<a href="tutorial-get-fancy-cli-output.html">Get fancy CLI output</a>
	      </li>
	    </ul>
	  </div>
	</li>
	<hr style="margin-top: 15px;">
	<li>
	  <button class="collapsible" id="m03"><a href="how-to-guides.html">How-to guides&nbsp;&nbsp;&nbsp;</a></button>
	  <div class="content" id="m04">
	    <ul>
	      <li>
		<button class="collapsible" id="m05"><a href="how-to-set-up-maas.html">Set up MAAS&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m06">
		  <ul>
		    <li>
		      <a href="how-to-install-maas.html">Install MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-upgrade-maas.html">Upgrade MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-back-up-maas.html">Back up MAAS</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m07"><a href="how-to-manage-maas-networks.html">Manage MAAS networks&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m08">
		  <ul>
		    <li>
		      <a href="how-to-connect-maas-networks.html">Connect MAAS networks</a>
		    </li>
		    <li>
		      <a href="how-to-enable-dhcp.html">Enable DHCP</a>
		    </li>
		    <li>
		      <a href="how-to-use-availability-zones.html">Use availability zones</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m09"><a href="how-to-manage-maas-images.html">Manage MAAS images&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m10">
		  <ul>
		    <li>
		      <a href="how-to-use-standard-images.html">Use standard images</a>
		    </li>
		    <li>
		      <a href="how-to-mirror-maas-images.html">Mirror MAAS images</a>
		    </li>
		    <li>
		      <a href="how-to-deploy-a-real-time-kernel.html">Deploy a real-time kernel</a>
		    </li>
		    <li>
		      <a href="how-to-use-vmware-images.html">Use VMWare images</a>
		    </li>
		    <li>
		      <a href="how-to-deploy-a-fips-compliant-kernel.html">Deploy a FIPS-compliant kernel</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m12"><a href="how-to-customise-images.html">Customise images&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m13">
		  <ul>
		    <li>
		      <a href="how-to-build-maas-images.html">Build MAAS images</a>
		    </li>
		    <li>
		      <a href="how-to-build-an-ubuntu-image.html">Build an Ubuntu image</a>
		    </li>
		    <li>
		      <a href="how-to-build-a-rhel-7-image.html">Build a RHEL 7 image</a>
		    </li>
		    <li>
		      <a href="how-to-build-a-rhel-8-image.html">Build a RHEL 8 image</a>
		    </li>
		    <li>
		      <a href="how-to-build-a-centos-7-image.html">Build a CentOS 7 image</a>
		    </li>
		    <li>
		      <a href="how-to-build-an-esxi-image.html">Build an ESXi image</a>
		    </li>
		    <li>
		      <a href="how-to-build-a-windows-image.html">Build a Windows image</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m14"><a href="how-to-manage-controllers.html">Manage controllers&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m15">
		  <ul>
		    <li>
		      <a href="how-to-configure-controllers.html">Configure controllers</a>
		    </li>
		    <li>
		      <a href="how-to-enable-high-availability.html">Enable high availability</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m16"><a href="how-to-use-machines.html">Use machines&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m17">
		  <ul>
		    <li>
		      <a href="how-to-manage-machines.html">Manage machines</a>
		    </li>
		    <li>
		      <a href="how-to-customise-machines.html">Customise machines</a>
		    </li>
		    <li>
		      <a href="how-to-commission-machines-with-maas.html">Commission machines</a>
		    </li>
		    <li>
		      <a href="how-to-allocate-machines-with-maas.html">Allocate machines</a>
		    </li>
		    <li>
		      <a href="how-to-deploy-machines-with-maas.html">Deploy machines</a>
		    </li>
		    <li>
		      <a href="how-to-use-resource-pools.html">Use resource pools</a>
		    </li>
		    <li>
		      <a href="how-to-set-up-power-drivers.html">Set up power drivers</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m18"><a href="how-to-manage-storage.html">Manage storage&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m19">
		  <ul>
		    <li>
		      <a href="how-to-configure-storage-layouts.html">Configure storage layouts</a>
		    </li>
		    <li>
		      <a href="how-to-manage-block-devices.html">Manage block devices</a>
		    </li>
		    <li>
		      <a href="how-to-manage-partitions.html">Manage partitions</a>
		    </li>
		    <li>
		      <a href="how-to-manage-vmfs-datastores.html">Manage VMFS datastores</a>
		    </li>
		    <li>
		      <a href="how-to-create-custom-storage.html">Create custom storage</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m20"><a href="how-to-use-virtual-machines.html">Use virtual machines&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m21">
		  <ul>
		    <li>
		      <a href="how-to-set-up-external-lxd.html">Set up external LXD</a>
		    </li>
		    <li>
		      <a href="how-to-use-external-lxd.html">Use external LXD</a>
		    </li>
		    <li>
		      <a href="how-to-use-lxd-projects.html">Use LXD projects</a>
		    </li>
		    <li>
		      <a href="how-to-manage-virtual-machines.html">Manage virtual machines</a>
		    </li>
		    <li>
		      <a href="how-to-deploy-vms-on-ibm-z.html">Deploy VMs on IBM Z</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m22"><a href="how-to-label-machines.html">Label machines&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m23">
		  <ul>
		    <li>
		      <a href="how-to-manage-tags.html">Manage
			tags</a>
		    </li>
		    <li>
		      <a href="how-to-annotate-machines.html">Annotate
			machines</a>
		    </li>
		    <li>
		      <a href="how-to-use-machine-tags.html">Use
			machine tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-controller-tags.html">Use
			controller tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-storage-tags.html">Use
			storage tags</a>
		    </li>
		    <li>
		      <a href="how-to-use-network-tags.html">Use
			network tags</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m24"><a href="how-to-use-logging.html">Use logging&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m25">
		  <ul>
		    <li>
		      <a href="how-to-read-event-logs.html">Read event logs</a>
		    </li>
		    <li>
		      <a href="how-to-review-audit-logs.html">Review audit logs</a>
		    </li>
		    <li>
		      <a href="how-to-read-commissioning-logs.html">Read commissioning logs</a>
		    </li>
		    <li>
		      <a href="how-to-interpret-testing-logs.html">Interpret testing logs</a>
		    </li>
		    <li>
		      <a href="how-to-use-maas-systemd-logs.html">Use MAAS systemd logs</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m26"><a href="how-to-secure-maas.html">Secure MAAS&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m27">
		  <ul>
		    <li>
		      <a href="how-to-enhance-maas-security">Enhance MAAS security</a>
		    </li>
		    <li>
		      <a href="how-to-manage-user-access.html">Manage user access</a>
		    </li>
		    <li>
		      <a href="how-to-implement-tls.html">Implement TLS</a>
		    </li>
		    <li>
		      <a href="how-to-integrate-vault.html">Integrate Vault</a>
		    </li>
		    <li>
		      <a href="how-to-configure-an-air-gapped-maas.html">Configure an air-gapped MAAS</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m28"><a href="how-to-change-maas-settings.html">Change MAAS settings&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m29">
		  <ul>
		    <li>
		      <a href="how-to-change-maas-3-4-settings.html">Change MAAS 3.4 settings</a>
		    </li>
		    <li>
		      <a href="how-to-change-maas-3-3-settings.html">Change MAAS 3.3 settings</a>
		    </li>
		    <li>
		      <a href="how-to-change-settings-with-the-cli.html">Change settings with the CLI</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m30"><a href="how-to-operate-maas.html">Operate MAAS&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m31">
		  <ul>
		    <li>
		      <a href="how-to-locate-machines.html">Locate machines</a>
		    </li>
		    <li>
		      <a href="how-to-monitor-maas.html">Monitor MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-audit-maas.html">Audit MAAS</a>
		    </li>
		    <li>
		      <a href="how-to-upgrade-postgresql-v12-to-v14.html">Upgrade PostgreSQL v12 to v14</a>
		    </li>
		    <li>
		      <a href="how-to-troubleshoot-common-issues.html">Troubleshoot common issues</a>
		    </li>
		    <li>
		      <a href="how-to-authenticate-to-the-maas-api.html">Authenticate to the MAAS API</a>
		    </li>
		    <li>
		      <a href="how-to-use-the-python-api-client.html">Use the Python API client</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m32"><a href="how-to-join-the-community.html">Join the community&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m33">
		  <ul>
		    <li>
		      <a href="how-to-engage-on-the-discourse-forum.html">Engage on the Discourse forum</a>
		    </li>
		    <li>
		      <a href="https://ubuntu.com/pro">How to get support</a>
		    </li>
		    <li>
		      <a href="how-to-request-features.html">Request features</a>
		    </li>
		    <li>
		      <a href="how-to-report-and-review-bugs.html">Report and review bugs</a>
		    </li>
		    <li>
		      <a href="how-to-contribute-to-maas-documentation.html">Contribute to MAAS documentation</a>
		    </li>
		    <li>
		      <a href="how-to-contact-us.html">How to contact us</a>
		    </li>
		  </ul>
		</div>
	      </li>
	    </ul>
	  </div>
	</li>
	<hr style="margin-top: 15px;">
	<li>
	  <button class="collapsible" id="m34"><a href="reference.html">Reference&nbsp;&nbsp;&nbsp;</a></button>
	  <div class="content" id="m35">
	    <ul>
	      <li>
		<button class="collapsible" id="m36"><a href="reference-general-information.html">General information&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m37">
		  <ul>
		    <li>
		      <a href="reference-installation-requirements.html">Installation requirements</a>
		    </li>
		    <li>
		      <a href="https://launchpad.net/maas">MAAS source code</a>
		    </li>
		    <li>
		      <a href="reference-documentation-style-guide.html">Documentation style guide</a>
		    </li>
		    <li>
		      <a href="reference-maas-glossary.html">MAAS glossary</a>
		    </li>
		    <li>
		      <a href="https://ubuntu.com/community/code-of-conduct">MAAS community code of conduct</a>
		    </li>
		    <li>
		      <a href="reference-api-documentation.html">MAAS API reference</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m38"><a href="reference-maas-scripts.html">Scripts and automation&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m39">
		  <ul>
		    <li>
		      <a href="reference-commissioning-scripts.html">Commissioning scripts</a>
		    </li>
		    <li>
		      <a href="reference-hardware-test-scripts.html">Hardware test scripts</a>
		    </li>
		    <li>
		      <a href="reference-terraform.html">Terraform IAC</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<a href="reference-device-labels.html">Device labels</a>
	      </li>
	      <li>
		<a href="reference-maas-metrics.html">MAAS metrics</a>
	      </li>
	      <li>
		<a href="reference-power-drivers.html">Power drivers</a>
	      </li>
	      <li>
		<a href="reference-bmc-drivers.html">BMC drivers</a>
	      </li>
	      <li>
		<a href="reference-maas-storage.html">Storage reference</a>
	      </li>
	      <li>
		<button class="collapsible" id="m40"><a href="reference-release-notes.html">Release notes and version details&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m41">
		  <ul>
		    <li>
		      <a href="reference-release-notes-maas-3-4.html">MAAS
			3.4 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-3-3.html">MAAS
			3.3 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-3-2.html">MAAS
			3.2 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-3-1.html">MAAS
			3.1 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-3-0.html">MAAS
			3.0 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-2-9.html">MAAS
			2.9 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-2-8.html">MAAS
			2.8 release notes</a>
		    </li>
		    <li>
		      <a href="reference-release-notes-maas-2-7.html">MAAS
			2.7 release notes</a>
		    </li>
		  </ul>
		</div>
	      </li>
	    </ul>
	  </div>
	</li>
	<hr style="margin-top: 15px;">
	<li>
	  <button class="collapsible" id="m42"><a href="explanation.html">Explanation&nbsp;&nbsp;&nbsp;</a></button>
	  <div class="content" id="m43">
	    <ul>
	      <li>
		<a href="about-maas.html">MAAS</a>
	      </li>
	      <li>
		<button class="collapsible" id="m44"><a href="about-machines.html">Machines&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m45">
		  <ul>
		    <li>
		      <a    href="about-machine-basics.html">Machine
			basics</a>
		    </li>
		    <li>
		      <a href="about-commissioning-machines.html">Commissioning
			machines</a>
		    </li>
		    <li>
		      <a href="about-the-machine-life-cycle.html">The
			machine life-cycle</a>
		    </li>
		    <li>
		      <a href="about-deploying-machines.html">Deploying
			machines</a>
		    </li>
		    <li>
		      <a href="about-machine-customisation.html">Machine
			customisation</a>
		    </li>
		    <li>
		      <a href="about-deploying-running-machines.html">Deploying
			running machines</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m46"><a href="about-virtual-machines.html">Virtual machines&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m47">
		  <ul>
		    <li>
		      <a href="about-lxd.html">LXD</a>
		    </li>
		    <li>
		      <a href="about-lxd-projects.html">LXD projects</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m48"><a href="about-images.html">Images&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m49">
		  <ul>
		    <li>
		      <a href="about-standard-images.html">Standard images</a>
		    </li>
		    <li>
		      <a href="about-custom-images.html">Custom images</a>
		    </li>
		  </ul>
		</div>
	      <li>
		<a href="about-controllers.html">Controllers</a>
	      </li>
	      <li>
		<a href="about-device-labels.html">Device labels</a>
	      </li>
	      <li>
		<button class="collapsible" id="m50"><a href="about-maas-networks.html">MAAS networks&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m51">
		  <ul>
		    <li>
		      <a href="about-the-osi-model.html">The OSI model</a>
		    </li>
		    <li>
		      <a href="about-tcp-ip.html">TCP/IP</a>
		    </li>
		    <li>
		      <a href="about-dhcp-in-maas.html">DHCP in MAAS</a>
		    </li>
		    <li>
		      <a href="about-cloud-networking.html">Cloud networking</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<button class="collapsible" id="m52"><a href="about-monitoring-and-logging.html">Monitoring and logging&nbsp;&nbsp;&nbsp;</a></button>
		<div class="content" id="m53">
		  <ul>
		    <li>
		      <a href="about-maas-performance.html">MAAS performance</a>
		    </li>
		    <li>
		      <a href="about-maas-events.html">MAAS events</a>
		    </li>
		    <li>
		      <a href="about-audit-events.html">Audit events</a>
		    </li>
		    <li>
		      <a href="about-maas-logging.html">MAAS logging</a>
		    </li>
		  </ul>
		</div>
	      </li>
	      <li>
		<a href="about-maas-security.html">Ensuring security in MAAS</a>
	      </li>
	      <li>
	      </li>
	    </ul>
	  </div>
	</li>
      </ul>
    </div>
    <div class="container" style="float:left; width:60%; margin-left: 40px; margin-top:40px; margin-right:30px">
      
      <h1>How to use LXD projects</h1>
      <p>This page explains how to use LXD projects with MAAS.</p>
      <h2 id="create-a-new-lxd-project">Create a new LXD project</h2>
      <p>If you’re using MAAS from the CLI, you’ll want to make sure you’ve generated an API key and logged in before you attempt to create a VM host. These steps are fairly simple; first, you’ll need the MAAS URL, which for this example, is <code>http://192.168.33.91:5240/MAAS</code>. You can find this URL by typing:</p>
      <pre class="nohighlight"><code>$ maas --help</code></pre>
      <p>This will return a help string. The correct MAAS API URL is shown in the last entry, “admin:”</p>
      <pre class="nohighlight"><code>usage: maas [-h] COMMAND ...

      optional arguments:
        -h, --help      show this help message and exit

      drill down:
        COMMAND
          login         Log in to a remote API, and remember its description and credentials.
          logout        Log out of a remote API, purging any stored credentials.
          list          List remote APIs that have been logged-in to.
          refresh       Refresh the API descriptions of all profiles.
          init          Initialise MAAS in the specified run mode.
          config        View or change controller configuration.
          status        Status of controller services.
          migrate       Perform migrations on connected database.
          apikey        Used to manage a user&#39;s API keys. Shows existing keys unless --generate or --delete
                        is passed.
          configauth    Configure external authentication.
          createadmin   Create a MAAS administrator account.
          changepassword
                        Change a MAAS user&#39;s password.
          admin         Interact with http://192.168.33.91:5240/MAAS/api/2.0/</code></pre>
      <p>Next, you’ll need to generate the API key for your administrative user. You can this by entering the following at the command line:</p>
      <pre class="nohighlight"><code>$ sudo maas apikey --generate --username admin
      [sudo] password for $USERNAME:</code></pre>
      <p>This will return only the API key, which looks something like this:</p>
      <pre class="nohighlight"><code>PPWQWHs75G6rRmhgdQ:mskfQUYsSqBQnfCYC8:ZruUD3EmnQyhRLapR5whY4bV4h8n7zr7</code></pre>
      <p>Having both of these, you can login with the following command:</p>
      <pre class="nohighlight"><code>$ maas login admin http://192.168.33.91:5240/MAAS/api/2.0
      API key (leave empty for anonymous access): PPWQWHs75G6rRmhgdQ:mskfQUYsSqBQnfCYC8:ZruUD3EmnQyhRLapR5whY4bV4h8n7zr7</code></pre>
      <p>Note in this example, you could cut and paste both the MAAS API URL and the API key into the command, at appropriate points. When you log in successfully, you will obtain a help listing something like this:</p>
      <pre class="nohighlight"><code>
      You are now logged in to the MAAS server at
      http://192.168.33.91:5240/MAAS/api/2.0/ with the profile name &#39;admin&#39;.

      For help with the available commands, try:

        maas admin --help</code></pre>
      <p>Now that you’re logged in, you can create a new KVM with the following <code>maas $PROFILE vm-hosts create</code> command:</p>
      <pre class="nohighlight"><code>$ maas admin vm-hosts create --help
      usage: maas admin vm-hosts create [--help] [-d] [-k] [data [data ...]]

      Create a VM host


      This method accepts keyword arguments. Pass each argument as a
      key-value pair with an equals sign between the key and the value:
      key1=value1 key2=value key3=value3. Keyword arguments must come after
      any positional arguments.

      Create or discover a new VM host.

      :param type: Required. The type of VM host to create:
      ``lxd`` or ``virsh``.
      :type type: String

       :param power_address: Required. Address that gives
      MAAS access to the VM host power control. For example, for virsh
      ``qemu+ssh:-172.16.99.2#,system``
      For ``lxd``, this is just the address of the host.
      :type power_address: String

       :param power_user: Required. Username to use for
      power control of the VM host. Required for ``virsh``
      VM hosts that do not have SSH set up for public-key authentication.
      :type power_user: String

       :param power_pass: Required. Password to use for
      power control of the VM host. Required ``virsh`` VM hosts that do
      not have SSH set up for public-key authentication and for ``lxd``
      if the MAAS certificate is not registered already in the LXD server.
      :type power_pass: String

       :param name: Optional. The new VM host&#39;s name.
      :type name: String

       :param zone: Optional. The new VM host&#39;s zone.
      :type zone: String

       :param pool: Optional. The name of the resource
      pool the new VM host will belong to. Machines composed from this VM host
      will be assigned to this resource pool by default.
      :type pool: String

       :param tags: Optional. A tag or list of tags (
      comma delimited) to assign to the new VM host.
      :type tags: String

       :param project: Optional. For ``lxd`` VM hosts, the
      project that MAAS will manage. If not provided, the ``default`` project
      will be used. If a nonexistent name is given, a new project with that
      name will be created.
      :type project: String


      Common command-line options:
          --help, -h
          Show this help message and exit.
          -d, --debug
          Display more information about API responses.
          -k, --insecure
          Disable SSL certificate check
      stormrider@wintermute:~$ maas admin vmho</code></pre>
      <p>In the case of our example server, you’d type:</p>
      <pre class="nohighlight"><code>$ maas admin vm-hosts create type=lxd power_address=10.196.199.1:8443 project=keystone name=foo</code></pre>
      <p>You’d be greeted with a success result that looks something like this:</p>
      <pre class="nohighlight"><code>Success.
      Machine-readable output follows:
      {
          &quot;host&quot;: {
              &quot;system_id&quot;: &quot;hybned&quot;,
              &quot;__incomplete__&quot;: true
          },
          &quot;storage_pools&quot;: [
              {
                  &quot;id&quot;: &quot;default&quot;,
                  &quot;name&quot;: &quot;default&quot;,
                  &quot;type&quot;: &quot;dir&quot;,
                  &quot;path&quot;: &quot;/var/snap/lxd/common/lxd/storage-pools/default&quot;,
                  &quot;total&quot;: 248618848256,
                  &quot;used&quot;: 0,
                  &quot;available&quot;: 248618848256,
                  &quot;default&quot;: true
              },
              {
                  &quot;id&quot;: &quot;default2&quot;,
                  &quot;name&quot;: &quot;default2&quot;,
                  &quot;type&quot;: &quot;dir&quot;,
                  &quot;path&quot;: &quot;/var/snap/lxd/common/lxd/storage-pools/default2&quot;,
                  &quot;total&quot;: 248618848256,
                  &quot;used&quot;: 0,
                  &quot;available&quot;: 248618848256,
                  &quot;default&quot;: false
              }
          ],
          &quot;type&quot;: &quot;lxd&quot;,
          &quot;used&quot;: {
              &quot;cores&quot;: 0,
              &quot;memory&quot;: 0,
              &quot;local_storage&quot;: 0
          },
          &quot;zone&quot;: {
              &quot;name&quot;: &quot;default&quot;,
              &quot;description&quot;: &quot;,
              &quot;id&quot;: 1,
              &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/zones/default/&quot;
          },
          &quot;total&quot;: {
              &quot;cores&quot;: 0,
              &quot;memory&quot;: 0,
              &quot;local_storage&quot;: 497237696512
          },
          &quot;tags&quot;: [
              &quot;pod-console-logging&quot;
          ],
          &quot;architectures&quot;: [
              &quot;amd64/generic&quot;
          ],
          &quot;available&quot;: {
              &quot;cores&quot;: 0,
              &quot;memory&quot;: 0,
              &quot;local_storage&quot;: 497237696512
          },
          &quot;pool&quot;: {
              &quot;name&quot;: &quot;default&quot;,
              &quot;description&quot;: &quot;Default pool&quot;,
              &quot;id&quot;: 0,
              &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/resourcepool/0/&quot;
          },
          &quot;default_macvlan_mode&quot;: null,
          &quot;name&quot;: &quot;foo&quot;,
          &quot;version&quot;: &quot;4.13&quot;,
          &quot;id&quot;: 26,
          &quot;memory_over_commit_ratio&quot;: 1.0,
          &quot;cpu_over_commit_ratio&quot;: 1.0,
          &quot;capabilities&quot;: [
              &quot;composable&quot;,
              &quot;dynamic_local_storage&quot;,
              &quot;over_commit&quot;,
              &quot;storage_pools&quot;
          ],
          &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/vm-hosts/26/&quot;
      }</code></pre>
      <p>Note that we specified the project <code>keystone</code> as part of this creation step. We can now check the LXD project list and see if we did, in fact, create that project:</p>
      <pre class="nohighlight"><code>$ lxc project list
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      |        NAME         | IMAGES | PROFILES | STORAGE VOLUMES | NETWORKS |       DESCRIPTION       | USED BY |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      | default             | YES    | YES      | YES             | YES      | Default LXD project     | 5       |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      | keystone            | NO     | YES      | NO              | NO       | Project managed by MAAS | 1       |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      | maas_vm_host_001    | YES    | YES      | YES             | NO       |                         | 1       |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      | new_project         | NO     | YES      | NO              | NO       | Project managed by MAAS | 1       |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      | not-maas (current)  | YES    | YES      | YES             | NO       |                         | 3       |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      | pg-basebackup-tests | NO     | YES      | NO              | NO       | Project managed by MAAS | 16      |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+</code></pre>
      <p>Finally, we can switch to the project to get a detailed look:</p>
      <pre class="nohighlight"><code>$ lxc project switch keystone
      $ lxc list
      +------+-------+------+------+------+-----------+
      | NAME | STATE | IPV4 | IPV6 | TYPE | SNAPSHOTS |
      +------+-------+------+------+------+-----------+</code></pre>
      <p>You’ll note that, since we just created the VM host, without adding any VMs, the <code>keystone</code> project will be empty.</p>
      <h2 id="create-a-new-vm-in-a-project">Create a new VM in a project</h2>
      <p>Let’s say that you have created your VM host (called <code>foo</code>, in this case) with a new, empty project called <code>keystone</code>. Now you want to create (that is, compose) a VM is this project. You can accomplish this with a command similar to the following:</p>
      <pre class="nohighlight"><code>maas admin vm-host compose 26</code></pre>
      <p>The VM host ID is found from the <code>resource_uri</code> line of the JSON output that was returned when you created the VM host; in this case, that line looks like this, yielding the ID number <code>26</code>:</p>
      <pre class="nohighlight"><code>    &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/vm-hosts/26/&quot;</code></pre>
      <p>MAAS will create (compose) the VM and immediately commission it. You can see this by executing the following command:</p>
      <pre class="nohighlight"><code>maas admin machines read wx8xcr | grep status_name</code></pre>
      <p>In this example, we’re using the system ID returned as the <code>resource_uri</code> of the composed VM that was returned in the JSON from the <code>maas admin vm-host compose</code> command above. We receive output similar to the following:</p>
      <pre class="nohighlight"><code>    &quot;network_test_status_name&quot;: &quot;Unknown&quot;,
          &quot;testing_status_name&quot;: &quot;Passed&quot;,
          &quot;status_name&quot;: &quot;Ready&quot;,
          &quot;commissioning_status_name&quot;: &quot;Passed&quot;,
          &quot;other_test_status_name&quot;: &quot;Unknown&quot;,
          &quot;storage_test_status_name&quot;: &quot;Passed&quot;,
          &quot;interface_test_status_name&quot;: &quot;Unknown&quot;,
          &quot;cpu_test_status_name&quot;: &quot;Unknown&quot;,
          &quot;memory_test_status_name&quot;: &quot;Unknown&quot;,</code></pre>
      <p>You can see by the several status messages that this machine was successfully commissioned, sitting now in the ready state.</p>
      <p>So from this experiment, we can see that creating (composing) a VM in a VM host causes MAAS to automatically commission the VM.</p>
      <h2 id="move-a-vm-to-a-project">Move a VM to a project</h2>
      <p>We’ve seen what happens if we compose a VM in a VM host – it’s automatically commissioned. But what if we move an existing VM into a LXD project that’s associated with a MAAS VM host? Let’s try it and see.</p>
      <p>First, let’s check on an existing VM in one of our other projects:</p>
      <pre class="nohighlight"><code>$ lxc project switch not-maas
      $ lxc list
      +-----------------+---------+------+------+-----------------+-----------+
      |      NAME       |  STATE  | IPV4 | IPV6 |      TYPE       | SNAPSHOTS |
      +-----------------+---------+------+------+-----------------+-----------+
      | trusty-drake    | STOPPED |      |      | VIRTUAL-MACHINE | 0         |
      +-----------------+---------+------+------+-----------------+-----------+
      | upward-stallion | STOPPED |      |      | CONTAINER       | 0         |
      +-----------------+---------+------+------+-----------------+-----------+
      $ lxc move trusty-drake trusty-drake --project not-maas --target-project keystone
      $ lxc project switch keystone
      $ lxc list
      +--------------+---------+------+------+-----------------+-----------+
      |     NAME     |  STATE  | IPV4 | IPV6 |      TYPE       | SNAPSHOTS |
      +--------------+---------+------+------+-----------------+-----------+
      | handy-sloth  | STOPPED |      |      | VIRTUAL-MACHINE | 0         |
      +--------------+---------+------+------+-----------------+-----------+
      | trusty-drake | STOPPED |      |      | VIRTUAL-MACHINE | 0         |
      +--------------+---------+------+------+-----------------+-----------+</code></pre>
      <p>We can check the status with MAAS, but we’ll find that the machine isn’t recognised. If we turn it on, it will be enlisted by MAAS. Since MAAS doesn’t know about it yet, we need to turn it on with the following command:</p>
      <pre class="nohighlight"><code>lxc start trusty-drake</code></pre>
      <p>Nothing happens for a while, but eventually MAAS will discover the machine and attempt to commission it. In fact, since MAAS doesn’t know what power type to use, it completes all the commissioning scripts except <code>30-maas-01-bmc-config</code>:</p>
      <table>
      <colgroup>
      <col style="width: 17%" />
      <col style="width: 17%" />
      <col style="width: 22%" />
      <col style="width: 17%" />
      <col style="width: 25%" />
      </colgroup>
      <thead>
      <tr class="header">
      <th style="text-align: left;">Name</th>
      <th style="text-align: center;">Tags</th>
      <th style="text-align: center;">Result</th>
      <th style="text-align: left;">Date</th>
      <th style="text-align: right;">Runtime</th>
      </tr>
      </thead>
      <tbody>
      <tr class="odd">
      <td style="text-align: left;">20-maas-01-install-lldpd</td>
      <td style="text-align: center;">node</td>
      <td style="text-align: center;">Passed</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:42:22</td>
      <td style="text-align: right;">0:00:00</td>
      </tr>
      <tr class="even">
      <td style="text-align: left;">20-maas-02-dhcp-unconfigured-ifaces</td>
      <td style="text-align: center;">node</td>
      <td style="text-align: center;">Passed</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:42:22</td>
      <td style="text-align: right;">0:00:00</td>
      </tr>
      <tr class="odd">
      <td style="text-align: left;">30-maas-01-bmc-config</td>
      <td style="text-align: center;">bmc-config, node</td>
      <td style="text-align: center;">Skipped</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:42:22</td>
      <td style="text-align: right;">0:00:00</td>
      </tr>
      <tr class="even">
      <td style="text-align: left;">50-maas-01-commissioning</td>
      <td style="text-align: center;">node</td>
      <td style="text-align: center;">Passed</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:42:23</td>
      <td style="text-align: right;">0:00:00</td>
      </tr>
      <tr class="odd">
      <td style="text-align: left;">maas-capture-lldpd</td>
      <td style="text-align: center;">node</td>
      <td style="text-align: center;">Passed</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:43:17</td>
      <td style="text-align: right;">0:00:53</td>
      </tr>
      <tr class="even">
      <td style="text-align: left;">maas-get-fruid-api-data</td>
      <td style="text-align: center;">node</td>
      <td style="text-align: center;">Passed</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:42:26</td>
      <td style="text-align: right;">0:00:00</td>
      </tr>
      <tr class="odd">
      <td style="text-align: left;">maas-kernel-cmdline</td>
      <td style="text-align: center;">node</td>
      <td style="text-align: center;">Passed</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:42:25</td>
      <td style="text-align: right;">0:00:01</td>
      </tr>
      <tr class="even">
      <td style="text-align: left;">maas-list-modaliases</td>
      <td style="text-align: center;">node</td>
      <td style="text-align: center;">Passed</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:42:25</td>
      <td style="text-align: right;">0:00:00</td>
      </tr>
      <tr class="odd">
      <td style="text-align: left;">maas-lshw</td>
      <td style="text-align: center;">node</td>
      <td style="text-align: center;">Passed</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:42:26</td>
      <td style="text-align: right;">0:00:02</td>
      </tr>
      <tr class="even">
      <td style="text-align: left;">maas-serial-ports</td>
      <td style="text-align: center;">node</td>
      <td style="text-align: center;">Passed</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:42:24</td>
      <td style="text-align: right;">0:00:00</td>
      </tr>
      <tr class="odd">
      <td style="text-align: left;">maas-support-info</td>
      <td style="text-align: center;">node</td>
      <td style="text-align: center;">Passed</td>
      <td style="text-align: left;">Mon, 19 Apr. 2021 21:42:25</td>
      <td style="text-align: right;">0:00:01</td>
      </tr>
      </tbody>
      </table>
      <p>This machine will sit in the “New” state until you assign it a power type, and enter the correct power parameters.</p>
      <p>For example, to get this new (moved) VM ready to be fully commissioned, you’ll need to first find it in the machine list:</p>
      <pre class="nohighlight"><code>maas admin machines read
      (lots of JSON output, down to the last line)
        &quot;resource_uri&quot;: &quot;/MAAS/api/2.0/machines/r3mmsh/&quot;</code></pre>
      <h2 id="hide-lxd-from-maas">Hide LXD from MAAS</h2>
      <p>Suppose that want to use MAAS with your default LXD project, and that you have a couple of LXD entities in your default project that you don’t want to use with MAAS:</p>
      <pre class="nohighlight"><code>$ lxc list
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      |      NAME       |  STATE  |         IPV4          |                    IPV6                     |      TYPE       | SNAPSHOTS |
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      | trusty-drake    | STOPPED |                       |                                             | VIRTUAL-MACHINE | 0         |
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      | upward-stallion | RUNNING | 10.196.199.194 (eth0) | fd42:ec:5a53:59d2:216:3eff:febf:7fa7 (eth0) | CONTAINER       | 0         |
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      | witty-lizard    | STOPPED |                       |                                             | VIRTUAL-MACHINE | 0         |
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+</code></pre>
      <p>In the above example, you want to use <code>witty-lizard</code> with MAAS, but you want to move the other two entities to a project called <code>not-maas</code>. To accomplish this, you first need to create the <code>not-maas</code> project if it doesn’t exist:</p>
      <pre class="nohighlight"><code>$ lxc project create not-maas
      Project not-maas created
      $ lxc project list
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      |        NAME         | IMAGES | PROFILES | STORAGE VOLUMES | NETWORKS |       DESCRIPTION       | USED BY |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      | default (current)   | YES    | YES      | YES             | YES      | Default LXD project     | 7       |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      | maas_vm_host_001    | YES    | YES      | YES             | NO       |                         | 1       |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      | not-maas            | YES    | YES      | YES             | NO       |                         | 1       |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+
      | pg-basebackup-tests | NO     | YES      | NO              | NO       | Project managed by MAAS | 16      |
      +---------------------+--------+----------+-----------------+----------+-------------------------+---------+</code></pre>
      <p>Having done so, you now want to move <code>trusty-drake</code> and <code>upward-stallion</code> to a new project. Let’s tackle <code>trusty-drake</code> first:</p>
      <pre class="nohighlight"><code>$ lxc move trusty-drake trusty-drake --project default --target-project not-maas --verbose
      $ lxc list
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      |      NAME       |  STATE  |         IPV4          |                    IPV6                     |      TYPE       | SNAPSHOTS |
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      | upward-stallion | RUNNING | 10.196.199.194 (eth0) | fd42:ec:5a53:59d2:216:3eff:febf:7fa7 (eth0) | CONTAINER       | 0         |
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      | witty-lizard    | STOPPED |                       |                                             | VIRTUAL-MACHINE | 0         |
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      $ lxc project switch not-maas
      $ lxc list
      +--------------+---------+------+------+-----------------+-----------+
      |     NAME     |  STATE  | IPV4 | IPV6 |      TYPE       | SNAPSHOTS |
      +--------------+---------+------+------+-----------------+-----------+
      | trusty-drake | STOPPED |      |      | VIRTUAL-MACHINE | 0         |
      +--------------+---------+------+------+-----------------+-----------+</code></pre>
      <p>It’s important to note that the <code>move</code> step may take 30 seconds or more; that’s normal.</p>
      <p>Next, let’s try moving <code>upward-stallion</code>, which is a running container:</p>
      <pre class="nohighlight"><code>$ lxc move upward-stallion upward-stallion --project default --target-project not-maas --verbose
      Error: Failed creating instance record: Failed initialising instance: Invalid devices: Failed detecting root disk device: No root device could be found
      $ lxc list
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      |      NAME       |  STATE  |         IPV4          |                    IPV6                     |      TYPE       | SNAPSHOTS |
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      | upward-stallion | RUNNING | 10.196.199.216 (eth0) | fd42:ec:5a53:59d2:216:3eff:fe64:a206 (eth0) | CONTAINER       | 0         |
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+
      | witty-lizard    | STOPPED |                       |                                             | VIRTUAL-MACHINE | 0         |
      +-----------------+---------+-----------------------+---------------------------------------------+-----------------+-----------+</code></pre>
      <p>Hmm, what’s that error message about? Well, you actually need to add the default storage pool to the mix, with this command:</p>
      <pre class="nohighlight"><code>lxc profile device add default root disk path=/ pool=default</code></pre>
      <p>Having done so, you can try the move again:</p>
      <pre class="nohighlight"><code>$ lxc move upward-stallion upward-stallion --project default --target-project not-maas --verbose
      $ lxc list                            
      +--------------+---------+------+------+-----------------+-----------+
      |     NAME     |  STATE  | IPV4 | IPV6 |      TYPE       | SNAPSHOTS |
      +--------------+---------+------+------+-----------------+-----------+
      | witty-lizard | STOPPED |      |      | VIRTUAL-MACHINE | 0         |
      +--------------+---------+------+------+-----------------+-----------+
      $ lxc project switch not-maas
      $ lxc list
      +-----------------+---------+------+------+-----------------+-----------+
      |      NAME       |  STATE  | IPV4 | IPV6 |      TYPE       | SNAPSHOTS |
      +-----------------+---------+------+------+-----------------+-----------+
      | trusty-drake    | STOPPED |      |      | VIRTUAL-MACHINE | 0         |
      +-----------------+---------+------+------+-----------------+-----------+
      | upward-stallion | STOPPED |      |      | CONTAINER       | 0         |
      +-----------------+---------+------+------+-----------------+-----------+</code></pre>
      <p>The move succeeds this time – with an important distinction: the compartment <code>upward-stallion</code> was <code>STOPPED</code> by <code>lxc</code> during the move. This is an important planning consideration when you’re trying to create MAAS VMs and VM hosts in an already-active LXD instantiation.</p>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
	  let coll = document.getElementsByClassName("collapsible");

	  for (let i = 0; i < coll.length; i++) {
	      coll[i].addEventListener("click", function() {
		  toggleCollapsible(this);
	      });
	  }
      });

      function toggleCollapsible(element) {
	  element.classList.toggle("active");
	  let content = element.nextElementSibling;
	  if (content.style.display === "none" || content.style.display === "") {
	      content.style.display = "block";
	  } else {
	      content.style.display = "none";
	  }
      }

      // Assuming you have a way to identify which menu item should be open, e.g., via URL
      function openMenuItemBasedOnPage() {
	  let currentPage = window.location.href; // or however you determine the current page
	  let menuItem;

	  // Logic to determine which menu item corresponds to the current page
	  if (currentPage.includes("page1")) {
	      menuItem = document.getElementById("menu-item-1");
	  } else if (currentPage.includes("page2")) {
	      menuItem = document.getElementById("menu-item-2");
	  }

	  if (menuItem) {
	      toggleCollapsible(menuItem);
	      menuItem.classList.add("active");
	  }
      }

      // Call this function when the page loads
      openMenuItemBasedOnPage();
    </script>
  </body>
</html>
